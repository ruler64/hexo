<!-- build time:Fri Aug 23 2024 15:57:47 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="icon" type="image/ico" sizes="32x32" href="/hexo/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Rulerの博客" href="https://ruler64.github.io/hexo/rss.xml"><link rel="alternate" type="application/atom+xml" title="Rulerの博客" href="https://ruler64.github.io/hexo/atom.xml"><link rel="alternate" type="application/json" title="Rulerの博客" href="https://ruler64.github.io/hexo/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/hexo/css/app.css?v=0.2.5"><meta name="keywords" content="视觉设计,slam"><link rel="canonical" href="https://ruler64.github.io/hexo/slam%E6%96%B9%E5%90%91/"><title>slam 方向 - 笔记 | Ruler's Blog = Ruler の博客 = 与天对弈，初心不改</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="reliefload"><span style="--i:0"></span> <span style="--i:1"></span> <span style="--i:2"></span> <span style="--i:3"></span> <span style="--i:4"></span> <span style="--i:5"></span> <span style="--i:6"></span></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline"><a href="/hexo/slam%E6%96%B9%E5%90%91" class="link external" itemprop="url">slam 方向<i class="ic i-link-alt"></i></a></h1><div class="meta"><span class="item" title="创建时间：2024-07-18 08:32:44"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-07-18T08:32:44+08:00">2024-07-18</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.2k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/hexo/" rel="start">Ruler's Blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclga70tsj20zk0m84mr.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/008s4A3Tly8h7amladf2gj31hc0u043c.jpg"></li><li class="item" data-background-image="https://s1.ax1x.com/2022/10/19/xsRCVO.png"></li><li class="item" data-background-image="https://pic1.imgdb.cn/item/634faf2716f2c2beb1479eef.png"></li><li class="item" data-background-image="https://pic1.imgdb.cn/item/634fac3116f2c2beb142fc73.png"></li><li class="item" data-background-image="https://s1.ax1x.com/2022/10/19/xsRQIg.png"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/hexo/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/hexo/categories/note/" itemprop="item" rel="index" title="分类于 笔记"><span itemprop="name">笔记</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="cn"><link itemprop="mainEntityOfPage" href="https://ruler64.github.io/hexo/slam%E6%96%B9%E5%90%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/hexo/img/avatar.jpg"><meta itemprop="name" content="Ruler"><meta itemprop="description" content="与天对弈，初心不改, 路漫漫其修远兮，吾将上下而求索"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ruler の博客"></span><div class="body md" itemprop="articleBody"><div class="note info"><p>slam 方向主要是作为机器人的地图构建与轨迹判断。利用相机的照片估计机器人距离物体的距离。</p></div><h1 id="旋转矩阵"><a class="anchor" href="#旋转矩阵">#</a> 旋转矩阵</h1><p>A=RA'</p><p>A 为三维向量，R 为 3*3 的旋转矩阵。</p><ul><li>旋转矩阵为正交矩阵，他的逆与他的转置相等</li><li>旋转矩阵的行列式为 + 1</li></ul><p>在 C++ 的 eigen 库中通过乘法 * 旋转某个向量</p><h1 id="旋转向量角轴"><a class="anchor" href="#旋转向量角轴">#</a> 旋转向量 / 角轴</h1><ul><li>除了旋转矩阵之外的旋转表示</li><li>三维旋转：三自由度，用 R³ 向量表示。方向为旋转轴，长度为旋转过的角度</li></ul><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token assign-left variable">w</span><span class="token operator">=</span>jn（j为角度，n为单位方向向量，w为轴）</pre></td></tr></table></figure><p>角轴与旋转矩阵的不同：</p><ul><li>旋转矩阵：九个量，有正交性约束和行列式值约束</li><li>角轴：三个量，没有约束</li></ul><p>角轴也就是<strong>李代数</strong>。</p><p>转换关系：</p><ul><li>轴角（旋转向量）转旋转矩阵：罗德里格斯公式</li><li>旋转矩阵转轴角：<ul><li>角度：o=arccos ((tr (R)-1)/2)</li><li>轴：Rn=n.</li></ul></li></ul><p>在 C++ 的 eigen 库中通过乘法 * 旋转某个向量</p><h1 id="变换矩阵"><a class="anchor" href="#变换矩阵">#</a> 变换矩阵</h1><p>变换矩阵是为了将旋转（旋转矩阵）和平移可以放入同一个矩阵。</p><p>将其写成 b=Ta</p><p>在 C++ 的 eigen 库中通过乘法 * 变换某个向量（旋转 + 平移）</p><h1 id="四元数"><a class="anchor" href="#四元数">#</a> 四元数</h1><p>四元数有三个虚部，可以表达三维空间中的旋转<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><msup><mi>q</mi><mn>0</mn></msup><mo>+</mo><msup><mi>q</mi><mn>1</mn></msup><mi>i</mi><mo>+</mo><msup><mi>q</mi><mn>2</mn></msup><mi>j</mi><mo>+</mo><msup><mi>q</mi><mn>3</mn></msup><mi>k</mi></mrow><annotation encoding="application/x-tex">q=q^0+q^1i+q^2j+q^3k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span></p><p>虚部间的关系：i²=-1，ij=k，ji=-k，jk=i，kj=-i，ki=j，ik=-j</p><p>四元数和角轴的关系</p><ul><li>角轴到四元数：</li><li>四元数到角轴：</li></ul><p>类似可知四元数亦可转换为旋转矩阵、欧拉角（欧拉角将旋转分解为<strong>三次</strong>不同轴上的转动，以便理解）</p><p>四元数相比与角轴、欧拉角的优势：紧凑、无奇异性。</p><p>用四元数旋转一个空间点，即将其在三维空间的三个坐标分别赋值在四元数的三个虚部，实部为 0，则其成功变为用四元数表示的坐标</p><p>在 C++ 的 eigen 库中通过乘法 * 旋转某个向量</p><h1 id="李群与李代数"><a class="anchor" href="#李群与李代数">#</a> 李群与李代数</h1><ul><li>三维世界中刚体运动的描述：<strong>旋转矩阵</strong>、<strong>旋转向量（角轴）</strong>、<strong>欧拉角</strong>、<strong>四元数</strong>。</li><li>除了<strong>表示</strong>之外，我们还要对它们进行<strong>估计</strong>和<strong>优化</strong>。</li><li>旋转矩阵自身带有<strong>约束</strong>（正交且行列式为 1），作为优化变量时会引入额外的约束，使优化变得困难。</li><li>李代数上可以变成<strong>无约束</strong>优化。</li></ul><h2 id="李群李代数基础"><a class="anchor" href="#李群李代数基础">#</a> 李群李代数基础</h2><p 3x3="">三维<strong>旋转</strong>矩阵构成了特殊正交<strong>群</strong> SO (3) R^</p><p 4x4="">三维<strong>变换</strong>矩阵构成了特殊欧式<strong>群</strong> SE (3) R^</p><ul><li><strong>群</strong>是一种集合加上一种运算的代数结构。</li><li>记集合为 A，运算为.，那么当运算满足以下性质时，称（A，.）成群：</li></ul><ol><li>封闭性</li><li>结合律</li><li>幺元</li><li>逆</li></ol><p>李群（Lie Group）：</p><ul><li>具有连续（光滑）性质的群。</li><li>既是群也是流形。</li><li>直观上看，一个刚体能够连续地在空间中运动，故 SO (3) 和 SE (3) 都是李群。</li><li>但是，旋转矩阵 SO (3) 和变换矩阵 SE (3) 只有定义良好的乘法，没有加法，所以难以进行取极限、求导等动作。</li></ul><p>李代数：与李群对应的一种结构，位于向量空间。</p><ul><li>通常记作小写的 so (3) 和 se (3)。</li><li>事实上是李群单位元处的正切空间。</li></ul><p>李代数的引出：</p><ul><li>任意旋转矩阵 R，满足：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msup><mi>R</mi><mi>T</mi></msup><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">RR^T=I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8413309999999999em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span></span></li></ul><p><img data-src="34.png" alt=""></p><h2 id="李代数求导与扰动模型"><a class="anchor" href="#李代数求导与扰动模型">#</a> 李代数求导与扰动模型</h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mn>0</mn><mrow></mrow></msubsup><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(t)=exp(\phi_0^{}t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.363em"><span style="top:-2.4518920000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p><p>该式说明，对任意 t，都可以找到一个 R 和一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">ϕ</span></span></span></span> 的对应关系</p><ul><li>该关系称为指数映射</li><li>这里的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">ϕ</span></span></span></span> 称为 SO (3) 对应的李代数：so (3)，并且 so (3) 的物理意义就是旋转向量</li></ul><p>李群经过<strong>对数</strong>映射变为李代数</p><p>李代数经过<strong>指数</strong>映射变为李群</p><p>对 R 对应的李代数加上小量，求相对于小量的变化率（导数模型）；</p><p>对 R 左乘或右乘一个小量，求相对于小量的李代数的变化率（扰动模型）。</p><h1 id="相机模型"><a class="anchor" href="#相机模型">#</a> 相机模型</h1><ul><li>小孔成像模型</li></ul><p><img data-src="1.png" alt=""></p><p>原始形式：\(\frac Z f\)=\(\frac {-X} {X'}\)=\(\frac {-Y} {Y'}\)</p><p>翻转到前面：\(\frac Z f\)=\(\frac {X} {X'}\)=\(\frac {Y} {Y'}\)</p><p>整理之后：X'=f\(\frac X Z\) Y'=f\(\frac Y Z\)</p><ul><li>成像平面下 X,Y,Z 到像素坐标 u，v</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>u</mi><mo>=</mo><mi>α</mi><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>v</mi><mo>=</mo><mi>β</mi><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin {cases} u =\alpha X&#x27;+c_x\\ v =\beta Y&#x27;+c_y\\ \end {cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.0037em">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.05278em">β</span><span class="mord"><span class="mord mathnormal" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.0037em">α</span></span></span></span> 与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.05278em">β</span></span></span></span> 分别表示 x 轴与 y 轴的缩放<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">c_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">c_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示 x 轴与 y 轴的平移</p><p>可以进一步化简为：</p><p><img data-src="2.png" alt=""></p><p><strong>当 Z=1 时为归一化平面坐标，当 Z 有确切的值时，为三维的 3D 坐标</strong></p><p>我们称矩阵 K 为<strong>内参</strong>（相机出厂自带的参数），P 为相机坐标。</p><p><img data-src="3.png" alt=""></p><p>从像素坐标到相机坐标再到世界坐标，实现了世界坐标到像素坐标的变换</p><p><img data-src="4.png" alt=""></p><h2 id="双目模型"><a class="anchor" href="#双目模型">#</a> 双目模型</h2><p><img data-src="5.png" alt=""></p><h1 id="图像"><a class="anchor" href="#图像">#</a> 图像</h1><p><img data-src="6.png" alt=""></p><p>有彩图与深度图即可得到像素坐标 (u,v)，然后根据公式可得相机坐标 (X,Y,Z)，最后可以根据相机位恣（旋转 + 平移）即可推出世界坐标。</p><h1 id="非线性优化"><a class="anchor" href="#非线性优化">#</a> 非线性优化</h1><h2 id="状态估计问题"><a class="anchor" href="#状态估计问题">#</a> 状态估计问题</h2><p><img data-src="7.png" alt=""></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">w_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为运动方程的噪声。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_{k,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 为观测方程的噪声。</li></ul><p>历史上很长一段时间使用<strong>滤波器</strong>求解状态估计，但近些年<strong>非线性优化</strong>已成为主流。</p><p><img data-src="8.png" alt=""></p><ul><li><strong>先验分布</strong>：根据一般的经验认为随机变量应该满足的分布。<strong>先验分布是你瞎猜参数服从啥分布</strong>。</li><li><strong>后验分布</strong>：通过当前训练数据修正的随机变量的分布，比先验分布更符合当前数据。<strong>后验分布是你学习经验后有根据地瞎猜参数服从啥分布</strong>。</li><li><strong>似然估计</strong>：已知训练数据，给定了模型，通过让似然性极大化估计模型参数的一种方法。<strong>似然估计是你猜参数是多少，才最能解释某些实验结果</strong>。</li></ul><p><strong>后验概率</strong></p><p>若老王花了一个小时的时间完成了 10 公里的距离，那么很大可能是骑车过去的，当然也有较小可能老王是个健身达人跑步过去的，或者开车过去但是堵车很严重。若老王一共用了两个小时的时间完成了 10 公里的距离，那么很有可能他是走路过去的。若老王只用了二十分钟，那么很有可能是开车。这种先知道结果，然后由结果估计原因的<span class="exturl" data-url="aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTYlQTYlODIlRTclOEUlODclRTUlODglODYlRTUlQjglODMmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw">概率分布</span>，<em>p</em> (交通方式 | 时间)，就是<strong>后验概率</strong>。</p><p><strong>先验概率</strong></p><p>老王早上起床的时候觉得精神不错，想锻炼下身体，决定跑步过去；也可能老王想做个文艺青年试试最近流行的共享单车，决定骑车过去；也可能老王想炫个富，决定开车过去。老王的选择与到达目的地的时间无关。先于结果，确定原因的概率分布，<em>p</em> (交通方式)，就是<strong>先验概率</strong>。</p><p><strong>似然函数</strong></p><p>老王决定步行过去，那么很大可能 10 公里的距离大约需要两个小时；较小可能是老王平时坚持锻炼，跑步过去用了一个小时；更小可能是老王是个猛人，40 分钟就到了。老王决定骑车过去，很可能一个小时就能到；较小可能是老王那天精神不错加上单双号限行交通很通畅，40 分钟就到了；还有一种较小可能是老王运气很差，连着坏了好几辆共享单车，花了一个半小时才到。老王决定开车过去，很大可能是 20 分钟就到了，较小可能是那天堵车很严重，磨磨唧唧花了一个小时才到。这种先确定原因，根据原因来估计结果的概率分布，<em>p</em> (时间 | 交通方式)，就是<strong>似然估计</strong>。</p><p><img data-src="9.png" alt=""></p><p><strong>从最大似然到最小二乘</strong></p><p><img data-src="10.png" alt=""></p><p><img data-src="11.png" alt=""></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>u</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_{k-1},u_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 为运动方程轨迹当前<strong>理论</strong>上的值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为运动方程<strong>实际</strong>上的值</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_k,y_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 为观测方程像素当前<strong>理论</strong>上的值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{k,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 为观测方程<strong>实际</strong>上的值</li></ul><p><img data-src="12.png" alt=""></p><p>当误差最小时，显然得出最大似然估计值。</p><p>对于 J (x) 函数，有以下解释：</p><ul><li>直观解释<ul><li>由于噪声的存在，当我们把估计的轨迹与地图代入 SLAM 的运动、观测方程中时，他们并不会完美成立。</li><li>此时就调整状态的估计，使得误差最小化。</li></ul></li><li>该问题有何结构？<ul><li>由许多个误差的平方和组成。</li><li>虽然总体维度高，但每个项很简单，只关联 2 个变量。</li><li>如果用李代数表达位姿，那么是无约束优化问题。</li></ul></li><li>如何求解？<ul><li>下面先来介绍通用的<strong>非线性最小二乘</strong>问题。</li></ul></li></ul><h2 id="非线性最小二乘"><a class="anchor" href="#非线性最小二乘">#</a> 非线性最小二乘</h2><p><img data-src="13.png" alt=""></p><p><strong>迭代方式：</strong></p><p><img data-src="14.png" alt=""></p><p><img data-src="15.png" alt=""></p><p>梯度：指函数<strong>增长</strong>的方向；增量方向取负梯度即为取函数下降方向</p><p><img data-src="16.png" alt=""></p><ul><li>最速下降法和牛顿法虽然直观，但实用当中存在一些缺点<ul><li>最速下降法会碰到 zigzag 问题（过于贪婪），导致迭代次数多</li><li>牛顿法迭代次数少，但需要计算复杂的<strong> Hessian</strong> 矩阵</li></ul></li><li>能否回避 Hessian 的计算？<ul><li><strong>Gauss-Newton</strong> 高斯牛顿</li><li><strong>Levenberg-Marquadt</strong></li></ul></li></ul><p><img data-src="17.png" alt=""></p><ul><li><strong>Gauss-Newton</strong> 简单实用，但<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>x</mi><mi>k</mi></msub><mo>=</mo><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>g</mi></mrow><annotation encoding="application/x-tex">\varDelta x_k=H^{-1}g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathit">Δ</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span> 当中无法保证 H 可逆（二次近似不可靠）</li><li><strong>Levenberg-Marquadt</strong> 方法一定程度上改善了它<ul><li><strong>G-N</strong> 属于线搜索方法：先找到方向，再确定长度</li><li><strong>L-M</strong> 属于信赖区域方法（Trust Region），认为近似只在区域内可靠<ul><li>考虑近似程度的描述\rho=\(\frac {f(x+\Delta x)-f(x)} {J(x)\Delta x}\)	实际下降 / 近似下降</li><li>若太小，即<strong>实际下降</strong> &lt;<strong> 近似下降</strong>，则认为不可靠，减小近似范围</li><li>若太大，即<strong>实际下降</strong> &gt;<strong> 近似下降</strong>，则认为可靠，增加近似范围</li></ul></li></ul></li></ul><p><img data-src="18.png" alt=""></p><p><img data-src="19.png" alt=""></p><div class="note info"><p>💡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>H</mi><mo>+</mo><mi>λ</mi><mi>I</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>=</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">(H+\lambda I)\Delta x=g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span></p><p><strong>LM</strong> 相比于<strong> GN</strong>，能够保证增量方程的正定性</p><ul><li>即认为近似只在一定范围内成立，如果近似不好则缩小范围</li></ul><p>从增量方程上来看，可以看成一阶和二阶的混合</p><ul><li>参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">λ</span></span></span></span> 控制着两边的权重</li></ul></div><p><strong>小结</strong></p><ul><li>非线性优化的主要方法：最速下降、牛顿、<strong>G-N</strong>、<strong>L-M</strong>、<strong>DogLeg</strong> 等</li><li>与线性规划不同，非线性需要针对具体问题具体分析</li><li>问题非凸时，对初值敏感，会陷入局部最优<ul><li>目前没有非凸问题的通用最优值的寻找办法</li><li>问题凸时，二阶方法通常一两步就能收敛</li></ul></li></ul><p><strong>实践：CERES</strong></p><ul><li>实验：曲线拟合</li><li>设曲线方程：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">y=exp(ax^2+bx+c)+w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span></li><li>我们希望得到一些带噪声的样本数据：x，y</li><li>希望拟合（回归）曲线参数：a，b，c</li></ul><p><strong>实践：G2O</strong></p><p><img data-src="20.png" alt=""></p><h1 id="视觉里程计"><a class="anchor" href="#视觉里程计">#</a> 视觉里程计</h1><h2 id="特征点法"><a class="anchor" href="#特征点法">#</a> 特征点法</h2><p>在经典<strong> SLAM</strong> 模型中是以<strong>位姿</strong>和<strong>路标（Landmark）<strong>来描述</strong> SLAM</strong> 过程。</p><p>路标是三维空间中固定不变的点，能够在特定位姿下观测到</p><ul><li>路标点数量充足，以实现良好的定位</li><li>路标点具有较好的区分性，以实现数据关联</li></ul><p>在视觉<strong> SLAM</strong> 中，可利用图像<strong>特征点</strong>作为<strong> SLAM</strong> 中的路标</p><p><img data-src="21.png" alt=""></p><p>特征点：图像中具有代表性的部分</p><ul><li>可重复性</li><li>可区别性</li><li>高效</li><li>本地</li></ul><p>特征点的信息</p><ul><li>位置、大小、方向、评分等──关键点</li><li>特征点周围的图像信息──描述子<ul><li>例子：<strong>SIFT/SURF/ORB</strong> 见<strong> OpenCV features2d 模块</strong></li></ul></li></ul><p>例子：<strong>ORB</strong> 特征</p><ul><li>关键点：<strong>Oriented FAST</strong></li><li>描述：<strong>BRIEF</strong></li></ul><p><strong>FAST</strong></p><ul><li>连续 N 个点的灰度值大于中间点</li><li><img data-src="22.png" alt=""></li></ul><p><strong>Oriented FAST</strong></p><ul><li>在<strong> FAST</strong> 基础上计算旋转</li></ul><p><img data-src="23.png" alt=""></p><p>特征匹配</p><ul><li>通过描述子的差异判断哪些特征为同一个点<ul><li>暴力匹配：比较图 1 中每个特征和图 2 特征的距离</li><li>加速：快速最近邻（FLANN）</li></ul></li></ul><h2 id="2d-2d对极几何"><a class="anchor" href="#2d-2d对极几何">#</a> 2D-2D：对极几何</h2><p>特征匹配之后，得到了特征点之间的对应关系</p><p>如果只有两个单目图像，得到 2D-2D 间的关系──对极几何</p><p>如果匹配的是帧和地图，得到 3D-2D 间的关系──PnP</p><p>如果匹配的是 RGB-D 图，得到 3D-3D 间的关系──ICP</p><p><img data-src="24.png" alt=""></p><p><img data-src="25.png" alt=""></p><p><img data-src="26.png" alt=""></p><p><img data-src="27.png" alt=""></p><p>八点法的讨论</p><ul><li>用于单目 SLAM 的初始化</li><li>尺度不确定性，归一化 t 或特征点的平均深度</li><li>纯旋转问题：t=0 时无法求解</li><li>多于八对点时：最小二乘或 RANSAC</li></ul><p><img data-src="28.png" alt=""></p><p><img data-src="29.png" alt=""></p><p><strong>小结</strong></p><p>2D-2D 情况下，只知道图像坐标之间的对应关系</p><ul><li>当特征点在平面上时（例如俯视或仰视），使用 H 恢复 R,t</li><li>否则，实用 E 或 F 恢复 R,t</li></ul><p>求得 R,t 后：</p><ul><li>利用三角化计算特征点的 3D 位置（即深度）</li></ul><h2 id="三角化"><a class="anchor" href="#三角化">#</a> 三角化</h2><p><img data-src="30.png" alt=""></p><p><img data-src="31.png" alt=""></p><h2 id="3d-2dpnp"><a class="anchor" href="#3d-2dpnp">#</a> 3D-2D：PNP</h2><p>已知 3D 点的空间位置和相机上的投影点，求相机的旋转和平移（外参）</p><p>代数的解法 / 优化的解法：</p><ul><li>代数的：DLT/P3P/EPnP/UPnP/……</li><li>优化的：Bundle Adjustment</li></ul><p><img data-src="32.png" alt=""></p><p><img data-src="33.png" alt=""></p><p><strong>DLT</strong> 将 R,t 看成独立的未知量，忽略了 R 本身正交且行列式为 1 的性质，所以其结果不一定都符合，所以在求出结果后，需要将 t 组成的矩阵投影回 SO (3)（通常用 QR 分解实现）；此外也可代入内参矩阵 K，但 SLAM 中一般假设 K 已知，所以这里没有代入。</p><h3 id="p3p"><a class="anchor" href="#p3p">#</a> P3P</h3><p><img data-src="35.png" alt=""></p><p><img data-src="36.png" alt=""></p><h3 id="bundle-adjustment"><a class="anchor" href="#bundle-adjustment">#</a> Bundle Adjustment</h3><hr><p><img data-src="37.png" alt=""></p><p>已知 3D 点 P，但是由于相机的<strong>旋转和平移</strong>的初始值不是很好，即<strong>外参</strong>（李代数）存在一定的误差。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>：本该投影到的位置；\^{P_2}：实际投影到的位置；e：误差。尽量让误差最小化使得相机的<strong>旋转和平移</strong>达到一个比较<strong>优化</strong>的值。</p><p>令误差为等式左右两边相减，问题在于如何去求误差关于相机位姿的导数，或者，按照哪个方向去优化相机的<strong>位姿</strong>（旋转 + 平移），即相机位姿发生变化时，误差会往哪个方向变？</p><p><img data-src="38.png" alt=""></p><p><img data-src="39.png" alt=""></p><p>假如，此时不光相机位姿不知道，连 3D 点都不知道，也就是说 3D 点也是会变的，那么可以直接对 3D 点求导，去推误差关于 3D 点的变化。</p><p><img data-src="40.png" alt=""></p><h2 id="3d-3dicp"><a class="anchor" href="#3d-3dicp">#</a> 3D-3D：ICP</h2><p><img data-src="41.png" alt=""></p><p><img data-src="42.png" alt=""></p><p><img data-src="43.png" alt=""></p><p><img data-src="44.png" alt=""></p><p>ICP 也可以从非线性优化角度求解，但：</p><ul><li>已知匹配时，ICP 问题存在唯一解或无穷多解的情况。在唯一解的情况下，只要能找到极小值解，那么这个<strong>极小值就是全局最优值</strong>。所以在正常情况下，SVD 结果和优化一样，且优化很快收敛。</li></ul><p>注：</p><ul><li>在激光情况下，匹配点未知，将指点最近点为匹配点。此时问题非凸，极小值不一定为最小值。</li><li>利用 ** 非线性优化（Bundle Adjustment 万金油）** 可以将 ICP 与 PnP 结合在一起求解。</li></ul><h2 id="直接法和光流"><a class="anchor" href="#直接法和光流">#</a> 直接法和光流</h2><p>回忆特征点法 VO 的做法</p><table><thead><tr><th style="text-align:center">做法</th><th style="text-align:center">耗时</th></tr></thead><tbody><tr><td style="text-align:center">在图像中提取特征点并计算特征描述</td><td style="text-align:center">非常耗时，~10ms in ORB</td></tr><tr><td style="text-align:center">在不同图像中寻找特征匹配</td><td style="text-align:center">非常耗时，O (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)</td></tr><tr><td style="text-align:center">利用匹配点信息计算相机位姿</td><td style="text-align:center">比较快速，&lt;1ms</td></tr></tbody></table><p>能否不使用特征匹配计算 VO？</p><p>不提特征计算 VO 的思路：</p><ol><li>通过其他方式寻找配对点<ul><li>光流</li></ul></li><li>无配对点<ul><li>直接法</li></ul></li></ol><p>一般分为稀疏光流和稠密光流</p><ul><li>稀疏以 Lucas-Kanade（LK）光流为代表</li><li>稠密以 Horn-Schunck（HS）光流为代表</li><li>本质上是估计像素在不同时刻图像中的运动</li></ul><p><img data-src="45.png" alt=""></p><h3 id="lk光流"><a class="anchor" href="#lk光流">#</a> LK 光流</h3><p>设 t 时刻位于 x,y 处像素点的灰度值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(x,y,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p><p>在 t+dt 时刻，该像素运动到了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>d</mi><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mi>d</mi><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo>+</mo><mi>d</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(x+dx,y+dy,t+dt)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p><ul><li>希望计算运动 dx,dy</li></ul><p>灰度不变假设：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>d</mi><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mi>d</mi><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo>+</mo><mi>d</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(x+dx,y+dy,t+dt)=I(x,y,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p><p>注意：灰度不变是一种理想的假设，实际当中由于高光 / 阴影 / 材质 / 曝光等不同，很可能不成立。</p><p><img data-src="46.png" alt=""></p><p><img data-src="47.png" alt=""></p><p><img data-src="48.png" alt=""></p><h3 id="直接法"><a class="anchor" href="#直接法">#</a> 直接法</h3><p><strong>光流</strong>仅估计了像素间的平移，但没有用到相机本身的几何结构，没有考虑到相机的旋转和图像的缩放；<strong>直接法</strong>则考虑了这些信息。</p><p><img data-src="49.png" alt=""></p><p><img data-src="50.png" alt=""></p><p><img data-src="51.png" alt=""></p><p><img data-src="52.png" alt=""></p><p><img data-src="53.png" alt=""></p><h1 id="后端"><a class="anchor" href="#后端">#</a> 后端</h1><h2 id="ekf滤波器形式后端"><a class="anchor" href="#ekf滤波器形式后端">#</a> EKF 滤波器形式后端</h2><p>从带噪声的数据估计内在状态──状态估计问题</p><ul><li>渐进式（Incremental）<ul><li>保持当前状态的估计，在加入新信息时，更新已有的估计（滤波）</li></ul></li><li>批量式（Batch）<ul><li>给定一定规模的数据，计算该数据下的最优估计（优化）</li></ul></li></ul><p><img data-src="54.png" alt=""></p><p><img data-src="55.png" alt=""></p><p><img data-src="56.png" alt=""></p><p><img data-src="57.png" alt=""></p><p><img data-src="58.png" alt=""></p><p><img data-src="59.png" alt=""></p><p><img data-src="60.png" alt=""></p><p><img data-src="61.png" alt=""></p><p><img data-src="62.png" alt=""></p><p><img data-src="63.png" alt=""></p><p><img data-src="64.png" alt=""></p><p><img data-src="65.png" alt=""></p><p><img data-src="66.png" alt=""></p><p>EKF</p><ul><li>优点：<ul><li>推导简单清楚，适用各种传感器形式</li><li>易于做多传感器融合</li></ul></li><li>缺点：<ul><li>一阶马尔可夫性过于简单</li><li>可能会发散（要求数据不能有 outlier）</li><li>线性化误差</li><li>需要存储所有状态量的均值和方差，平方增长</li></ul></li></ul><h2 id="ba与图优化"><a class="anchor" href="#ba与图优化">#</a> BA 与图优化</h2><p><img data-src="67.png" alt=""></p><p>BA 问题与图结构的关系</p><ul><li>BA 虽然是个纯优化问题，但亦可以用图模型清晰地表述出来</li><li>顶点为优化变量，边为运动 / 观测约束</li><li>本身还有一些特殊的结构</li></ul><p>考虑在位姿 i 处对路标 j 的一次观测<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_{ij}=z_{ij}-h(x_i,y_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8694379999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul><p>特点：</p><ul><li>每个观测只关系两个变量，其中一个是相机<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，一个是路标<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></li><li>纯视觉 BA 中，不存在相机与相机 / 路标与路标之间的关联</li><li>整个误差函数由许多个这样小的项组成</li></ul><p><img data-src="68.png" alt=""></p><p><img data-src="69.png" alt=""></p><p><img data-src="70.png" alt=""></p><p><img data-src="71.png" alt=""></p><p><img data-src="72.png" alt=""></p><p><img data-src="73.png" alt=""></p><p><img data-src="74.png" alt=""></p><p><img data-src="75.png" alt=""></p><div class="tags"><a href="/hexo/tags/%E8%A7%86%E8%A7%89%E8%AE%BE%E8%AE%A1-slam/" rel="tag"><i class="ic i-tag"></i> 视觉设计,slam</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-08-01 19:46:28" itemprop="dateModified" datetime="2024-08-01T19:46:28+08:00">2024-08-01</time> </span><span id="slam方向/" class="item leancloud_visitors" data-flag-title="slam 方向" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/hexo/img/wechatpay.png" alt="Ruler 微信支付"><p>微信支付</p></div><div><img data-src="/hexo/img/alipay.png" alt="Ruler 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>作者： </strong>Ruler <i class="ic i-at"><em>@</em></i>Ruler の博客</li><li class="link"><strong>本文链接：</strong> <a href="https://ruler64.github.io/hexo/slam%E6%96%B9%E5%90%91/" title="slam 方向">https://ruler64.github.io/hexo/slam方向/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/hexo/Redis%E7%9A%84Java%E5%AE%A2%E6%88%B7%E7%AB%AF/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic1.imgdb.cn&#x2F;item&#x2F;634fac3116f2c2beb142fc73.png" title="Redis的Java客户端"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 笔记</span><h3>Redis的Java客户端</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E7%9F%A9%E9%98%B5"><span class="toc-number">1.</span> <span class="toc-text">旋转矩阵</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E5%90%91%E9%87%8F%E8%A7%92%E8%BD%B4"><span class="toc-number">2.</span> <span class="toc-text">旋转向量 &#x2F; 角轴</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5"><span class="toc-number">3.</span> <span class="toc-text">变换矩阵</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">四元数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%8E%E7%BE%A4%E4%B8%8E%E6%9D%8E%E4%BB%A3%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">李群与李代数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%8E%E7%BE%A4%E6%9D%8E%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80"><span class="toc-number">5.1.</span> <span class="toc-text">李群李代数基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%8E%E4%BB%A3%E6%95%B0%E6%B1%82%E5%AF%BC%E4%B8%8E%E6%89%B0%E5%8A%A8%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">李代数求导与扰动模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B8%E6%9C%BA%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.</span> <span class="toc-text">相机模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E7%9B%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.1.</span> <span class="toc-text">双目模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F"><span class="toc-number">7.</span> <span class="toc-text">图像</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96"><span class="toc-number">8.</span> <span class="toc-text">非线性优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E4%BC%B0%E8%AE%A1%E9%97%AE%E9%A2%98"><span class="toc-number">8.1.</span> <span class="toc-text">状态估计问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98"><span class="toc-number">8.2.</span> <span class="toc-text">非线性最小二乘</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E9%87%8C%E7%A8%8B%E8%AE%A1"><span class="toc-number">9.</span> <span class="toc-text">视觉里程计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E7%82%B9%E6%B3%95"><span class="toc-number">9.1.</span> <span class="toc-text">特征点法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2d-2d%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95"><span class="toc-number">9.2.</span> <span class="toc-text">2D-2D：对极几何</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E8%A7%92%E5%8C%96"><span class="toc-number">9.3.</span> <span class="toc-text">三角化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3d-2dpnp"><span class="toc-number">9.4.</span> <span class="toc-text">3D-2D：PNP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#p3p"><span class="toc-number">9.4.1.</span> <span class="toc-text">P3P</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bundle-adjustment"><span class="toc-number">9.4.2.</span> <span class="toc-text">Bundle Adjustment</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3d-3dicp"><span class="toc-number">9.5.</span> <span class="toc-text">3D-3D：ICP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%B3%95%E5%92%8C%E5%85%89%E6%B5%81"><span class="toc-number">9.6.</span> <span class="toc-text">直接法和光流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lk%E5%85%89%E6%B5%81"><span class="toc-number">9.6.1.</span> <span class="toc-text">LK 光流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%B3%95"><span class="toc-number">9.6.2.</span> <span class="toc-text">直接法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF"><span class="toc-number">10.</span> <span class="toc-text">后端</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ekf%E6%BB%A4%E6%B3%A2%E5%99%A8%E5%BD%A2%E5%BC%8F%E5%90%8E%E7%AB%AF"><span class="toc-number">10.1.</span> <span class="toc-text">EKF 滤波器形式后端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ba%E4%B8%8E%E5%9B%BE%E4%BC%98%E5%8C%96"><span class="toc-number">10.2.</span> <span class="toc-text">BA 与图优化</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/hexo/thread-lock/" rel="bookmark" title="线程安全问题">线程安全问题</a></li><li><a href="/hexo/SpringMvc-Rest/" rel="bookmark" title="深入SpringMvc学习之路（一）Rest风格开发">深入SpringMvc学习之路（一）Rest风格开发</a></li><li><a href="/hexo/Docker%E5%AE%89%E8%A3%85/" rel="bookmark" title="Docker的安装">Docker的安装</a></li><li><a href="/hexo/Docker%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="Docker的学习">Docker的学习</a></li><li><a href="/hexo/Redis%E5%91%BD%E4%BB%A4/" rel="bookmark" title="Redis命令">Redis命令</a></li><li><a href="/hexo/Redis%E7%9A%84Java%E5%AE%A2%E6%88%B7%E7%AB%AF/" rel="bookmark" title="Redis的Java客户端">Redis的Java客户端</a></li><li class="active"><a href="/hexo/slam%E6%96%B9%E5%90%91/" rel="bookmark" title="slam方向">slam方向</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Ruler" data-src="/hexo/img/avatar.jpg"><p class="name" itemprop="name">Ruler</p><div class="description" itemprop="description">路漫漫其修远兮，吾将上下而求索</div></div><nav class="state"><div class="item posts"><a href="/hexo/archives/"><span class="count">9</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/hexo/categories/"><span class="count">3</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/hexo/tags/"><span class="count">8</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3J1bGVyNjQ=" title="https:&#x2F;&#x2F;github.com&#x2F;ruler64"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS94aS1zaGFuLXllLTM1" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;xi-shan-ye-35"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvcGxheWxpc3Q/aWQ9NzY2NTAyNDYzMg==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;playlist?id&#x3D;7665024632"><i class="ic i-cloud-music"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjEyNTI2OTc5OTFAcXEuY29t" title="mailto:1252697991@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/hexo/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/hexo/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/hexo/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/hexo/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/hexo/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item"><a href="/hexo/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a href="/hexo/statistics/" rel="section"><i class="ic i-clock"></i>统计</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/hexo/categories/tools/" title="分类于 工具">工具</a></div><span><a href="/hexo/hexo-url-optimization" title="Hexo博客url优化">Hexo博客url优化<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/Redis%E5%91%BD%E4%BB%A4" title="Redis命令">Redis命令<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/SpringMvc-Rest" title="深入SpringMvc学习之路（一）Rest风格开发">深入SpringMvc学习之路（一）Rest风格开发<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/Redis%E7%9A%84Java%E5%AE%A2%E6%88%B7%E7%AB%AF" title="Redis的Java客户端">Redis的Java客户端<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/Docker%E5%AD%A6%E4%B9%A0" title="Docker的学习">Docker的学习<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/thread-lock" title="线程安全问题">线程安全问题<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/%E9%A1%B9%E7%9B%AE/" title="分类于 项目">项目</a></div><span><a href="/hexo/SpringBoot-MybatisPlus-page" title="MybatisPlus之分页查询">MybatisPlus之分页查询<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/slam%E6%96%B9%E5%90%91" title="slam方向">slam方向<i class="ic i-link-alt"></i></a></span></li><li class="item"><div class="breadcrumb"><a href="/hexo/categories/note/" title="分类于 笔记">笔记</a></div><span><a href="/hexo/Docker%E5%AE%89%E8%A3%85" title="Docker的安装">Docker的安装<i class="ic i-link-alt"></i></a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Ruler @ Ruler's Blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">33k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">30 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"slam方向/",favicon:{show:"✩•‿• ʜᴀᴠᴇ ᴀ ɢᴏᴏᴅ ᴛɪᴍᴇ☄︎♡",hide:"(っ◞‸◟c)浏览器崩溃！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js,npm/echarts@5.2.2/dist/echarts.min.js"></script><script src="/hexo/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->